plot_bestfit_seds
    # 
    # usage:
    #   sm
    #   macro read do_plot_bestfit_seds.sm plot_bestfit_seds
    # 
    
    data fit.out
    read {i0 1.d chi2 2.f i1 3.d a1 4.f i2 5.d a2 6.f}
    sort {chi2 i0 i1 a1 i2 a2}
    
    device x11
    xtcolours
    define TeX_strings 1
    erase
    expand 1.50
    limits -1.5 5.5 -5 3
    ticksize -1 10 -1 10
    ctype default
    box
    expand 2.05
    xlabel "{\lambda} [{\mu}m]"
    
    define cid 0
    ctype blue
    plot_one_sed $(i1[0]/1001)
    
    define cid 1
    ctype skyblue
    plot_one_sed $(i1[1]/1001)
    
    define cid 2
    ctype seagreen
    plot_one_sed $(i1[2]/1001)
    
    #ctype yellow
    #plot_one_sed 20
    #ctype orange
    #plot_one_sed 30
    #ctype orangered
    #plot_one_sed 40
    #ctype red
    #plot_one_sed 50

plot_one_sed 02
    # 
    data "DL07.HiExCom.SPAH.lib.SED"
    lines $(19+i1[$cid]) $(19+i1[$cid]+1001-1)
    read {w1 1 f1 2}
    set f1 = f1*a1[$cid]
    set lg_w = lg(w1)
    set lg_f = lg(f1)
    #connect lg_w lg_f
    # 
    data "RadioPowerlaw.Single.lib.SED"
    lines 16 116
    read {w2 1 f2 2}
    set f2 = f2*a2[$cid]
    set lg_w = lg(w2)
    set lg_f = lg(f2)
    #connect lg_w lg_f
    # 
    set lg_ww = $fx1, $fx2, 0.01
    set sp_x = (lg(w1)) set sp_y = (lg(f1)) spline sp_x sp_y lg_ww lg_f1
    set sp_x = (lg(w2)) set sp_y = (lg(f2)) spline sp_x sp_y lg_ww lg_f2
    set lg_ff = lg(10**lg_f1 + 10**lg_f2)
    connect lg_ww lg_ff
    # 
    # calc LIR(8-1000)
    load astroSfig.sm
    set wave_um = 10**lg_ww
    set flux_mJy = 10**lg_ff
    set z = 0.5
    set ltir = calc_ltir(wave_um,flux_mJy,z)
    # 
    # calc S_(1.4GHz)
    set lg_wx = lg(2.00e5)
    spline lg_ww lg_ff lg_wx lg_fx
    echo "S_(1.4GHz) = "$(10**lg_fx)
    echo "a2 = "$(a2[$cid])
    # 
    # calc q_IR
    set dL = calc_lumdist(z)
    set q_IR = lg(ltir * 3.839e33 * 1e-7 / 3.75e12 / (10**lg_fx * 1e-3 * 1e-26 * (4*pi*(dL)**2 * 9.52140e44)))
    #calc 1.0 / (3.839e33 * 1e-7 / 3.75e12 / (1e-3 * 1e-26 * (9.52140e44)) / 40.31970) # = 3750!
    #so it is correct that 
    #       q_IR = lg( S_(IR,8-1000,mJy*GHz) / 3750 / S_(1.4GHz,mJy) )
    # 
    echo "dL = "$(dL)
    echo "q_IR = "$(q_IR)






