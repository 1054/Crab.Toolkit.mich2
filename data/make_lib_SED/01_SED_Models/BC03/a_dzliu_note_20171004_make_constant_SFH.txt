# cd bc03
# cd src
# vim Makefile
#  /replace gfortran with gfortran-mp-4.8/
# make
# make all


# vim ../src/.bc_bash


bash
cd ~/Softwares/BC03/
mkdir out
cd out
source ../src/.bc_bash
csp
../models/Padova1994/chabrier/bc2003_lr_BaSeL_m62_chab_ssp.ised # m62 0.02 (Z⊙)
N # Include attenuation by dust? Y/[N] N
  # Compute flux weighted age in the galaxy rest frame at z [0] = 
3 # Constant SFH
  # Enter SFR in Mo/yr [1] = 1
  # Make SFR = 0 at time > TCUT [20.0 Gyr] = 
out_constant_SFH # Output file name = out_constant_SFH
Ctrl + C

ls out_constant_SFH.ised
../src/ascii_ised out_constant_SFH.ised
ls out_constant_SFH.ised_ASCII

../src/interpolate_ised out_constant_SFH.ised 2e6 > out_constant_SFH_wave_flux_at_2Myr.txt

# By default, the spectra are output as luminosity per unit wavelength in units of L⊙ ̊A−1, with L⊙ = 3.826 × 10^33 ergs s−1.





















# 
# Below are something more detailed, 
# now I just use ../src/interpolate_ised to output the wave_flux. 
# 

# out_constant_SFH.ised_ASCII
# first line, 221 ages in yr. 
# the 7th line, 2023 wavelengths in Angstrom. 
# the 8th to 228th line (221 lines), 2023 fluxes in units of Lsun AA-1. Note that at age 0 all fluxes are 0. 
# 
# the 35th age is 1995300.00 yr ~ 2 Myr. 
cat out_constant_SFH.ised_ASCII | head -n 7 | tail -n 1 > out_constant_SFH.ised_ASCII.at_age_2Myr.txt
cat out_constant_SFH.ised_ASCII | head -n $((7+35)) | tail -n 1 >> out_constant_SFH.ised_ASCII.at_age_2Myr.txt

# 
# the first line contains wavelength
# the second line contains fluxes and paramters
# fluxes starts from the 2nd column to the nsteps+1=2024-th column, 
# then parameters starting from nsteps+2-th column to the end:
#     ml,
#     mu,
#     iseg,
#     (xx(i),lm(i),um(i),baux(i),cn(i),cc(i),i=1,iseg)
#     totm,
#     totn,
#     avs,
#     jo,
#     tau,
#     tau1,
#     tau2,
#     tau3,
#     tau4,
#     iop,
#     stelib